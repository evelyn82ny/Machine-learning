# 퍼셉트론(Perceptron)

퍼셉트로은 단계층으로 출력층만 존재한다. 출력층은 여러개의 출력 뉴런으로 구성이 가능하지만 퍼셉트론은 1개면 충분해 1개의 뉴런으로 되어있다.<br>

![png](/_img/ml/perceptron_expression.png) <br>

퍼셉트론은 mcculloch-pitts 뉴런 모델이며 활성화 함수는 Signum 함수를 번형해 사용한다.<br>
가중합에 bias가 아닌 임계치(threshold)를 포함하고 활성화 함수에 의해 1 또는 -1로 변환된다.<br>

1 또는 -1로 변환된 값 y를 퍼셉트론 출력이라고 한다.<br>
퍼셉트론 알고리즘을 훈련할 때 사용되는 학습데이터(학습샘플)는 입력 xi와 정답 di(목표 출력, target)쌍으로 구성된다. -> (xi, di) <br>
퍼셉트론 출력 y와 정답 d가 수렴할 때까지 학습하는데 이 과정에서 가중치가 계속해서 갱신된다.<br>

## Decision boundary에 의한 이진 분류

퍼셉트론의 활성화 함수는 1 또는 -1를 출력하기 때문에 이진 분류에 사용된다.<br>
몇개의 입력을 처리하는가에 따라 표현 방식이 다른데 다음과 같다.<br>

![png](/_img/ml/decision_boundary2.png) <br>

- 입력 변수가 1개인 경우 : 일직선상에서 점을 기준으로 분류
- 입력 변수가 2개인 경우 : 2차원에서 기울기를 기준으로 분류
- 입력 변수가 3개인 경우 : 3차원에서 기울기 벡터를 기준으로 분류
- 입력 번수가 4개 이상인 경우 : hyperplane으로 3차원 공간에서 평면을 뛰어넘은 평면을 의미(한다고 하는데...이 부분 관심가져보기)

![png](/_img/ml/decision_boundary1.png) <br>
평면에서 기울기로 이진 분류가 가능하다는 것은 퍼셉트론 적용이 가능하는 뜻이다.<br>
하지만 오른쪽과 같이 기울기가 아닌 non-linear 분리에서는 퍼셉트론을 적용할 수 없어 한계가 발생한다.<br>

## OR 연산에 퍼셉트론 적용하기

2개의 입력에 대한 OR 연산제 퍼셉트론을 적용할 수 있다. 즉, OR 연산의 모든 결과를 이진 분류할 수 있다는 뜻이다.<br>

![png](/_img/ml/perceptron_or.png) <br>

threshold를 1로 설정했기 때문에 가중합 v는 x1와 x2를 OR 연산한 결과에 -1을 더해주면 된다.<br>
왼쪽 2차원 좌표를 보면 음수의 값을 갖는 기울기에 의해 OR 연산 결과가 제대로 분리가능 하다는 것을 알 수 있다.<br>
가중치가 모두 1로 설정했기 때문에 정확한 분리를 할 수 있었는데 이처럼 적절한 가중치를 찾는 것을 학습이라고 한다.<br>

AND, NOT 연산도 퍼셉트론을 적용할 수 있지만 XOR 연산에서는 한계를 보인다.<br>

![png](/_img/ml/perceptron_xor.png) <br>

XOR 연산을 이진 분류하려 했지만 예외가 발생하므로 퍼셉트론을 적용할 수 없다.

## 가중치와 임계치 구하는 방법

![png](/_img/ml/cal_weight_threshold.png) <br>

## 가중치 갱신

퍼셉트론 결과 y와 목표 출력 d가 비슷한 값이 될 때까지 가중치를 변경해가며 학습한다.<br>
수렴하기 위해 가중치를 변경하는 방법은 다음과 같다.<br>

![png](/_img/ml/weight_update.png) <br>

> 아래에서 설명할 FN, FP에 대한 자세한 설명 : [https://evelyn82.github.io/ml/confusion-matrix/](https://evelyn82.github.io/ml/confusion-matrix/)<br>

퍼셉트론의 결과는 이진 분류이므로 **-1(false)**, **1(true)** 으로 해석하면 쉽게 이해할 수 있다.<br>

## 수렴, 발산, 진동

![png](/_img/ml/perceptron_convergence.png) <br>

- 퍼셉트론은 선형 분리 가능한 데이터에 대해서는 무조건 수렴한다. 수렴한다는 뜻은 이진 분류가 가능하다는 뜻이다.
- 하지만 선형 분리가 가능하지 않은 데이터에 대해서는 발산, 진동의 결과를 나타낸다.